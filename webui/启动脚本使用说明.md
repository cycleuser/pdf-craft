# PDF OCR 启动脚本使用说明

## 📋 可用启动脚本

### 1. `run_compatible.py` - 兼容模式 ⭐⭐⭐⭐⭐

**最新的兼容模式启动脚本，专为解决pdf_craft库兼容性问题设计**

#### 特点：

- ✅ 自动检测pdf_craft库支持的功能
- ✅ 自动禁用不兼容的高级功能
- ✅ 支持外网访问（默认 0.0.0.0）
- ✅ 最高的稳定性和兼容性
- ✅ 适合所有pdf_craft库版本

#### 使用方法：

```bash
# 基本启动（推荐）
python run_compatible.py

# 指定端口和主机
python run_compatible.py --host 0.0.0.0 --port 8080

# 启用调试模式
python run_compatible.py --debug
```

### 2. `run_improved.py` - 改进版

**改进版启动脚本，结合了多种优点**

#### 特点：

- ✅ 支持外网访问（默认 0.0.0.0）
- ✅ 自动检测硬件并应用最优配置
- ✅ 完整的系统检测和依赖检查
- ✅ 支持预设配置模式
- ✅ 详细的启动信息显示
- ⚠️ 可能与某些pdf_craft库版本不兼容

#### 使用方法：

```bash
# 基本启动
python run_improved.py

# 指定端口和主机
python run_improved.py --host 0.0.0.0 --port 8080

# 使用预设配置
python run_improved.py --preset balanced

# 查看所有预设配置
python run_improved.py --list-presets

# 禁用自动优化
python run_improved.py --no-auto-config

# 启用调试模式
python run_improved.py --debug
```

### 3. `run_optimized.py` - 性能优化版

**专注于性能优化的启动脚本**

#### 特点：

- ✅ 支持外网访问（已修复）
- ✅ 自动硬件检测和优化
- ✅ 4种预设配置模式
- ⚠️ 缺少基础系统检查
- ⚠️ 可能与某些pdf_craft库版本不兼容

#### 使用方法：

```bash
# 自动优化启动
python run_optimized.py

# 使用预设配置
python run_optimized.py --preset maximum_speed
```

### 4. `run.py` - 基础版（已改进）

**基础功能检查版，现已集成优化配置**

#### 特点：

- ✅ 支持外网访问
- ✅ 详细的系统检测
- ✅ 模型文件检查
- ✅ 已集成自动优化配置
- ⚠️ 可能与某些pdf_craft库版本不兼容

#### 使用方法：

```bash
# 基础启动
python run.py

# 指定端口
python run.py 8080
```

## 🎛️ 预设配置模式

### maximum_speed - 最大速度模式

- 适合：追求最快处理速度
- 特点：启用所有优化，可能牺牲少量质量
- 推荐硬件：高端GPU + 16GB+ 内存

### balanced - 平衡模式（推荐）

- 适合：大多数用户
- 特点：在速度和质量之间取得最佳平衡
- 推荐硬件：中端GPU + 8GB+ 内存

### maximum_quality - 最高质量模式

- 适合：追求最佳OCR质量
- 特点：优先保证质量，处理速度较慢
- 推荐硬件：任何配置

### low_resource - 低资源模式

- 适合：内存和CPU资源有限的设备
- 特点：最小化资源占用
- 推荐硬件：4GB+ 内存，4核+ CPU

## 🌐 网络访问配置

### 本地访问

```bash
python run_compatible.py --host 127.0.0.1 --port 5000
# 访问地址：http://localhost:5000
```

### 外网访问

```bash
python run_compatible.py --host 0.0.0.0 --port 5000
# 本地访问：http://localhost:5000
# 外网访问：http://[您的IP地址]:5000
```

### 指定IP访问

```bash
python run_compatible.py --host 192.168.1.100 --port 5000
# 访问地址：http://192.168.1.100:5000
```

## 🔧 故障排除

### 问题1：外网无法访问

**解决方案：**

1. 确保使用 `--host 0.0.0.0`
2. 检查防火墙设置
3. 确认端口未被占用

### 问题2：识别效果不佳

**解决方案：**

1. 使用 `run_compatible.py` 启动（推荐）
2. 确保模型文件正确下载
3. 检查GPU是否正确启用
4. 尝试不同的预设配置

### 问题3：启动失败

**解决方案：**

1. 检查依赖项：`pip install -r requirements.txt`
2. 确认Python版本兼容
3. 查看详细错误日志

### 问题4：模型下载失败

**解决方案：**

1. 检查网络连接
2. 手动下载模型文件到 `models/` 目录
3. 确保有足够的磁盘空间

### 问题5：批处理大小错误

**解决方案：**

1. 使用 `run_compatible.py` 启动，它会自动检测并适配pdf_craft库
2. 如果使用其他启动脚本，添加 `--no-auto-config` 参数禁用自动优化

## 📊 性能对比

| 启动脚本         | 外网访问 | 自动优化 | 系统检测 | 兼容性     | 推荐度     |
| ---------------- | -------- | -------- | -------- | ---------- | ---------- |
| run_compatible.py| ✅       | ✅       | ✅       | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ |
| run_improved.py  | ✅       | ✅       | ✅       | ⭐⭐⭐     | ⭐⭐⭐⭐   |
| run_optimized.py | ✅       | ✅       | ⚠️       | ⭐⭐       | ⭐⭐⭐     |
| run.py           | ✅       | ✅       | ✅       | ⭐⭐⭐     | ⭐⭐       |

## 💡 使用建议

1. **首次使用**：推荐使用 `run_compatible.py`
2. **生产环境**：使用 `run_compatible.py`
3. **开发调试**：使用 `run_compatible.py --debug`
4. **性能测试**：使用 `run_improved.py --preset maximum_speed`（如果兼容）
5. **资源受限**：使用 `run_improved.py --preset low_resource`（如果兼容）

## 🚀 快速开始

```bash
# 1. 安装依赖
pip install -r requirements.txt

# 2. 启动服务（推荐）
python run_compatible.py

# 3. 访问服务
# 本地：http://localhost:5000
# 外网：http://[您的IP]:5000
```

---

**注意**：首次运行时会自动下载模型文件，请确保网络连接正常且有足够的磁盘空间。
